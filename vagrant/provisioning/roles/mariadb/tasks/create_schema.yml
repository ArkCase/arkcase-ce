- name: create {{ item }} database
  become: yes
  mysql_db:
    login_host: "{{ database_host_name }}"
    login_user: "{{ rds_user | default('arkcase_root') }}"
    login_password: "{{ rds_password }}"
    name: "{{ item }}"
    encoding: utf8
    state: present
- name: create {{ item }} MySQL user
  become: yes
  mysql_user:
    login_host: "{{ database_host_name }}"
    login_user: "{{ rds_user | default('arkcase_root') }}"
    login_password: "{{ rds_password }}"
    host: "%"
    name: "{{ item }}"
    password: "{{ default_database_password }}"
    priv: '{{ item }}.*:select,insert,update,delete,create,drop,index,alter,lock tables,create view,trigger,create routine,alter routine,execute,REQUIRESSL'
    state: present
  no_log: true
- name: create {{ item }} MySQL user (IP address)
  become: yes
  mysql_user:
    login_host: "{{ database_host_name }}"
    login_user: "{{ rds_user | default('arkcase_root') }}"
    login_password: "{{ rds_password }}"
    host: "{{ ansible_default_ipv4.address|default(ansible_all_ipv4_addresses[0]) }}"
    name: "{{ item }}"
    password: "{{ default_database_password }}"
    priv: '{{ item }}.*:select,insert,update,delete,create,drop,index,alter,lock tables,create view,trigger,create routine,alter routine,execute,REQUIRESSL'
    state: present
  no_log: true
    

  
