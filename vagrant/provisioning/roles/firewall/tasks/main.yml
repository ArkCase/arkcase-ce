- name: enable firewall
  become: yes
  service:
    name: firewalld
    state: started

- name: Expose ArkCase app port
  become: yes
  firewalld:
    port: "{{ item }}"
    permanent: true
    state: enabled
    immediate: yes
  register: arkcase_ports
  loop:
    - "7070/tcp"   # alfresco
    - "8443/tcp"   # alfresco alternate
    - "443/tcp"    # httpd
    - "2002/tcp"   # pentaho
    - "8983/tcp"   # solr
    - "8843/tcp"   # arkcase
    - "2005/tcp"   # snowbound
    - "3306/tcp"   # MariaDB
    - "61616/tcp"  # ActiveMQ JMS
    - "61613/tcp"  # ActiveMQ STOMP

- name: Reload firewalld
  become: yes
  command: firewall-cmd --reload
  when: arkcase_ports is changed

